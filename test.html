<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Rerender - Quick Test</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      padding: 40px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    h1 {
      color: #667eea;
      font-size: 48px;
      margin-bottom: 20px;
    }

    .section {
      margin-bottom: 40px;
      padding: 30px;
      background: #f9fafb;
      border-radius: 8px;
    }

    .section h2 {
      color: #333;
      margin-bottom: 15px;
    }

    .status {
      background: #1e293b;
      color: white;
      padding: 20px;
      border-radius: 8px;
      margin: 20px 0;
      font-family: monospace;
    }

    .status div {
      margin-bottom: 8px;
    }

    .success {
      color: #4ade80;
    }

    .error {
      color: #f87171;
    }

    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      margin: 5px;
      font-size: 16px;
    }

    button:hover {
      background: #5568d3;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Web Rerender SDK Test</h1>

    <div class="status" id="status">
      <div>⏳ Loading SDK...</div>
    </div>

    <div class="section">
      <h2>Page 1: Introduction</h2>
      <p>
        This is a quick test page to verify the Web Rerender SDK is working correctly.
        The SDK should automatically detect your device, initialize pagination, and
        split this content into multiple pages.
      </p>
      <p>
        You should see pagination controls in the bottom-right corner. Use them or
        keyboard shortcuts (Arrow Keys, PageUp/Down) to navigate between pages.
      </p>
    </div>

    <div class="section">
      <h2>Page 2: Device Information</h2>
      <p>The SDK has detected the following about your device:</p>
      <div class="status" id="deviceInfo">
        <div>Loading device info...</div>
      </div>
    </div>

    <div class="section">
      <h2>Page 3: Input Information</h2>
      <p>The SDK has detected the following input methods:</p>
      <div class="status" id="inputInfo">
        <div>Loading input info...</div>
      </div>
    </div>

    <div class="section">
      <h2>Page 4: Navigation Controls</h2>
      <p>Test the navigation programmatically:</p>
      <button onclick="WebRerender.goToPage(1)">Go to Page 1</button>
      <button onclick="WebRerender.prevPage()">Previous Page</button>
      <button onclick="WebRerender.nextPage()">Next Page</button>
      <button onclick="goToLast()">Go to Last Page</button>
      <div class="status" id="pageInfo" style="margin-top: 20px;">
        <div>Current page: <span id="currentPage">-</span></div>
        <div>Total pages: <span id="totalPages">-</span></div>
      </div>
    </div>

    <div class="section">
      <h2>Page 5: Event Listening</h2>
      <p>Events captured from the SDK:</p>
      <div class="status" id="eventLog" style="max-height: 300px; overflow-y: auto;">
        <div>Waiting for events...</div>
      </div>
    </div>

    <div class="section">
      <h2>Page 6: Image Optimization</h2>
      <p>Test image optimization controls:</p>
      <button onclick="WebRerender.setImageOptimization(false)">Disable Images</button>
      <button onclick="WebRerender.setImageOptimization(true)">Enable Images</button>
      <div style="margin-top: 20px;">
        <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); height: 200px; border-radius: 8px;"></div>
      </div>
    </div>

    <div class="section">
      <h2>Page 7: Summary</h2>
      <p>
        If you can see this page and navigate between all pages, the SDK is working correctly!
      </p>
      <p><strong>Congratulations!</strong> The Web Rerender SDK is functioning as expected.</p>
      <div class="status">
        <div class="success">✓ SDK Initialized</div>
        <div class="success">✓ Device Detection Working</div>
        <div class="success">✓ Input Detection Working</div>
        <div class="success">✓ Pagination Working</div>
        <div class="success">✓ Navigation Controls Working</div>
        <div class="success">✓ Events Working</div>
      </div>
    </div>
  </div>

  <!-- Load the SDK -->
  <script src="sdk/dist/web-rerender.js"></script>

  <script>
    const statusEl = document.getElementById('status');
    const deviceInfoEl = document.getElementById('deviceInfo');
    const inputInfoEl = document.getElementById('inputInfo');
    const eventLogEl = document.getElementById('eventLog');
    const pageInfoEl = document.getElementById('pageInfo');

    // Initialize SDK
    (async function() {
      try {
        statusEl.innerHTML = '<div>⏳ Initializing SDK...</div>';

        await WebRerender.init({
          pagination: {
            mode: 'intelligent',
            breakpoints: 'semantic',
            controls: {
              enabled: true,
              position: 'bottom-right',
              keyboard: true
            }
          },
          images: {
            lazyLoad: true,
            quality: 'adaptive',
            userControl: true
          },
          debug: true
        });

        statusEl.innerHTML = '<div class="success">✓ SDK Initialized Successfully!</div>';
        logEvent('SDK initialized');

        // Display device info
        const device = WebRerender.getDeviceInfo();
        deviceInfoEl.innerHTML = `
          <div>Type: ${device.type}</div>
          <div>OS: ${device.os}</div>
          <div>Browser: ${device.browser}</div>
          <div>Screen: ${device.screen.width}x${device.screen.height}</div>
          <div>Orientation: ${device.screen.orientation}</div>
          <div>Pixel Ratio: ${device.pixelRatio}</div>
        `;

        // Display input info
        const input = WebRerender.getInputInfo();
        inputInfoEl.innerHTML = `
          <div>Primary: ${input.primary}</div>
          <div>Mouse: ${input.types.mouse ? '✓' : '✗'}</div>
          <div>Touch: ${input.types.touch ? '✓' : '✗'}</div>
          <div>Keyboard: ${input.types.keyboard ? '✓' : '✗'}</div>
          <div>Pen: ${input.types.pen ? '✓' : '✗'}</div>
        `;

        // Update page info
        updatePageInfo();

        // Setup event listeners
        WebRerender.on('pagination:pagechanged', (e) => {
          logEvent(`Page changed: ${e.detail.from} → ${e.detail.to}`);
          updatePageInfo();
        });

        WebRerender.on('images:toggled', (e) => {
          logEvent(`Images ${e.detail.enabled ? 'enabled' : 'disabled'}`);
        });

        WebRerender.on('viewport:changed', (e) => {
          logEvent(`Viewport changed to ${e.detail.new.category}`);
        });

        WebRerender.on('input:changed', (e) => {
          logEvent(`Input changed: ${e.detail.from} → ${e.detail.to}`);
        });

        console.log('Web Rerender initialized successfully!');

      } catch (error) {
        statusEl.innerHTML = `<div class="error">✗ Error: ${error.message}</div>`;
        console.error('Initialization error:', error);
      }
    })();

    function updatePageInfo() {
      document.getElementById('currentPage').textContent = WebRerender.getCurrentPage();
      document.getElementById('totalPages').textContent = WebRerender.getTotalPages();
    }

    function logEvent(message) {
      const time = new Date().toLocaleTimeString();
      const div = document.createElement('div');
      div.textContent = `[${time}] ${message}`;
      eventLogEl.insertBefore(div, eventLogEl.firstChild);

      // Keep only last 20 events
      while (eventLogEl.children.length > 20) {
        eventLogEl.removeChild(eventLogEl.lastChild);
      }
    }

    function goToLast() {
      const total = WebRerender.getTotalPages();
      WebRerender.goToPage(total);
    }
  </script>
</body>
</html>
